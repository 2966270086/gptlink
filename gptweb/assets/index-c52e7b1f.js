import{d as R,T,M as V,ah as j,b as i,r as x,B as D,aM as F,aQ as M,C as l,D as b,E as m,F as a,G as c,H as t,aq as P,_ as k,P as u,Q as E,R as G,I as Q,a4 as d,a5 as w,ap as C,aa as I,S as q,a9 as H,J,K,$ as O,a0 as W,U as X}from"./index-5a1db7f2.js";const Y=r=>(O("data-v-00ba503a"),r=r(),W(),r),Z={class:"bg-white w-11/12 sm:w-96 pb-6 rounded-lg"},ee={class:"text-xl text-[#4f555e] dark:text-white"},se={class:"pt-4"},te={class:"mx-auto max-w-5xl px-4 sm:px-6 lg:px-8 flex items-center"},ae={class:"sm:flex sm:items-end sm:space-x-5 justify-center"},ne={class:"flex justify-center"},oe=["src"],le={class:"flex-1 px-2"},re={class:"truncate font-bold text-gray-900"},ie={key:0},ce={key:0,class:"px-4 sm:px-6 lg:px-8 mt-4"},ue=Y(()=>a("div",{class:"font-semibold"}," 任务中心 ",-1)),de={class:"flex items-center"},pe={class:"flex-1 text-base italic font-medium truncate"},fe={class:"mt-1 text-xs ml-6 truncate"},me=R({__name:"index",props:{visible:{type:Boolean},share:{type:Function}},emits:["update:visible"],setup(r,{emit:N}){const _=r,S=T(),p=V(),g={invite:{title:"邀请好友",btn:"立即邀请",icon:"ant-design:user-add-outlined"},share:{title:"每日分享",btn:"立即分享",icon:"material-symbols:share"}};j();const h=i(()=>{var e;return((e=p.authInfo)==null?void 0:e.user)||{}}),y=x([]),v=x([]),f=x(null),o=i({get(){return _.visible},set(e){N("update:visible",e)}});D(()=>o.value,()=>{o.value&&p.authInfo&&($(),L())}),i(()=>{const e=y.value.filter(s=>s.num===-1);return e&&e.length?e[0].expired_at:"已失效"}),i(()=>{const e=y.value.filter(s=>s.num!==-1);if(e&&e.length){const{num:s,used:n}=e[0];return s-n>0?s-n:0}else return"0"});const B=i(()=>{const e=f.value||{};return Array.isArray(e)?null:e.num===-1?`有效期：${e.expired_at}`:`有效次数：${e.num-e.used}`}),$=async()=>{const{authInfo:e}=p;if(e)try{const s=await F.getUserNum();f.value=s}catch{}},A=()=>{const{authInfo:e}=p;return S[e?"push":"replace"]({name:e?"Combo":"Login"})},L=async()=>{const e=await M.getTaskList();v.value=e.filter(s=>s.type!=="register")},U=e=>{o.value=!1,_.share&&_.share(e)};return(e,s)=>(l(),b(t(K),{show:t(o),"onUpdate:show":s[1]||(s[1]=n=>J(o)?o.value=n:null),"auto-focus":!1},{default:m(()=>[a("div",Z,[c(t(P),{tooltip:"关闭",class:"absolute top-0 right-0",onClick:s[0]||(s[0]=n=>o.value=!1)},{default:m(()=>[a("span",ee,[c(t(k),{icon:"material-symbols:close"})])]),_:1}),a("div",se,[a("div",te,[a("div",ae,[a("div",ne,[t(h).avatar?(l(),u("img",{key:0,class:"h-8 w-8 rounded-full object-cover ring-4 ring-white",src:t(h).avatar,alt:""},null,8,oe)):(l(),b(t(E),{key:1,size:"medium",round:"",src:t(G)},null,8,["src"]))])]),a("div",{class:Q(["mt-3 flex-1 flex items-center userinfo",{"items-end":f.value}])},[a("div",le,[a("h1",re,d(t(h).nickname??""),1),f.value?(l(),u("div",ie,d(t(B)),1)):w("",!0)]),c(t(C),{type:"primary",size:"small",round:"",onClick:A},{default:m(()=>[I(" 去充值 ")]),_:1})],2)])]),v.value.length?(l(),u("div",ce,[ue,(l(!0),u(q,null,H(v.value,(n,z)=>(l(),u("div",{key:z,class:"bg-black rounded-lg shadow text-white py-2 px-3 mt-2"},[a("div",de,[c(t(k),{icon:g[n.type].icon,class:"mr-1",style:{color:"#fff","font-size":"20px"}},null,8,["icon"]),a("div",pe,d(n.title),1),c(t(C),{round:"",size:"small",style:{background:"#fff"},onClick:_e=>U(n)},{default:m(()=>[I(d(g[n.type].btn),1)]),_:2},1032,["onClick"])]),a("div",fe,d(n.desc),1)]))),128))])):w("",!0)])]),_:1},8,["show"]))}}),ve=X(me,[["__scopeId","data-v-00ba503a"]]);export{ve as default};

import{d as P,r as d,M as D,aP as V,Y as R,O as H,b as _,B as G,C as i,D as S,E as h,F as s,G as l,H as e,_ as j,ar as Q,ap as C,aa as I,I as F,al as J,P as k,a5 as L,J as K,K as X,L as Y,af as W,$ as E,a0 as M,ao as Z,U as O,a8 as ee,a4 as w,S as te,a9 as se,aM as ae,aQ as oe,T as ne,Q as A,R as le}from"./index-7dfc9e4e.js";import{c as ce}from"./index-31c42854.js";import{N as re}from"./InputGroup-82da841a.js";import{H as ie}from"./index-86a937c5.js";import{T as ue}from"./index-2f8bc5b5.js";const de="/assets/poster-34c80d2f.png",T=c=>(E("data-v-64465730"),c=c(),M(),c),pe={class:"share-body w-full flex flex-col items-center justify-center"},me={class:"text-xl text-[white]"},fe=T(()=>s("div",{class:"text-base text-[white] text-center mb-2"}," 专属邀请链接（90日后需重新获取） ",-1)),_e={class:"flex justify-center"},he=T(()=>s("div",{class:"text-base text-[white] text-center my-2"}," 专属邀请海报 ",-1)),xe={id:"poster",class:"poster bg-white overflow-hidden"},ve=["src"],ye=["src"],be=T(()=>s("div",{class:"w-3/6 text-sm text-[white] text-center mt-2"}," 保存上方图片，分享你专属海报给朋友 ",-1)),ge=P({__name:"index",props:{visible:{type:Boolean},data:null,type:null},emits:["update:visible"],setup(c,{emit:N}){const r=c,f=d(""),p=d(""),x=D(),{shareCallback:v}=V(),{isPrivateDomain:m}=R(),{domainConfig:y}=H(),b=_(()=>{var t;return((t=x.authInfo)==null?void 0:t.user)||{}}),U=_(()=>r.data||{}),u=_({get(){return r.visible},set(t){N("update:visible",t)}}),q=_(()=>{const{openid:t}=b.value,{type:a}=e(r);return`${window.location.origin}${a==="distribution"?"/distribution/apply":""}${t?`/?shareOpenId=${t}`:""}`});G(()=>u.value,async()=>{if(u.value){const{openid:t}=b.value,{type:a}=e(r);try{p.value=`${window.location.protocol}://${window.location.host}${a==="/distribution"?"/distribution/apply":""}/${t?`?shareOpenId=${t}`:""}`}catch{}Y(()=>{const o=document.querySelector("#poster");W(o,{useCORS:!0,scale:4,backgroundColor:null,ignoreElements:n=>{if(Z(n.className)&&n.className.includes("poster-img"))return!0},onclone:n=>{const{type:$}=e(r);if($==="distribution"){const g=n.querySelector(".distibution-info");g&&(g.style.transform="translate(-50%, -6.5px)")}else if(m){const g=n.querySelector(".qrcode");g.style.transform="translateX(-13.5px)",g.style.left="50%"}}}).then(n=>{const $=n.toDataURL();f.value=$}).catch(n=>{console.log(n)})})}});function z(){u.value=!1,v(U.value.type)}function B(){ce({text:p.value,dom:document.querySelector(".share-body")})}return(t,a)=>(i(),S(e(X),{show:e(u),"onUpdate:show":a[1]||(a[1]=o=>K(u)?u.value=o:null),"auto-focus":!1},{default:h(()=>{var o;return[s("div",pe,[s("div",{class:"close-btn flex justify-center items-center p-2 cursor-pointer fixed top-0 right-0",onClick:z},[s("span",me,[l(e(j),{icon:"material-symbols:close",style:{"font-size":"35px"}})])]),fe,s("div",_e,[l(e(re),null,{default:h(()=>[l(e(Q),{value:p.value,"onUpdate:value":a[0]||(a[0]=n=>p.value=n),class:"flex-1"},null,8,["value"]),l(e(C),{type:"primary",onClick:B},{default:h(()=>[I(" 复制链接 ")]),_:1})]),_:1})]),he,s("div",xe,[s("img",{src:e(m)?(o=e(y))==null?void 0:o.share_img:e(de),class:"w-full h-full poster-bg"},null,8,ve),l(J,{class:F(["qrcode",{qrcodeCenter:e(m)}]),value:e(q),size:50},null,8,["class","value"]),f.value?(i(),k("img",{key:0,src:f.value,class:"w-full h-full poster-img"},null,8,ye)):L("",!0)]),be])]}),_:1},8,["show"]))}}),we=O(ge,[["__scopeId","data-v-64465730"]]),ke=c=>(E("data-v-ac5b0b8c"),c=c(),M(),c),$e={class:"bg-white min-h-screen"},Se={class:"mx-auto w-11/12 sm:w-96"},Ce={class:"pt-8"},Ie={class:"mx-auto max-w-5xl px-4 sm:px-6 lg:px-8 flex items-center"},Ne={class:"sm:flex sm:items-end sm:space-x-5 justify-center"},Ue={class:"flex justify-center"},qe={class:"flex-1 flex items-center userinfo"},ze={class:"flex-1 px-2"},Be={class:"truncate font-bold text-gray-900"},Le={class:"flex items-center"},Te={class:"mx-4 flex items-center px-4 py-2 sm:px-6 lg:px-8 mt-6 bg-white shadow-2xl rounded-lg",style:{"--tw-shadow":"0 0px 15px -7px rgb(0 0 0 / 0.5)"}},Ae={class:"flex items-center flex-1 mr-4 py-2 text-gray-600"},Pe={key:0,class:"px-4 sm:px-6 lg:px-8 mt-4"},De=ke(()=>s("div",{class:"font-semibold"}," 任务中心 ",-1)),Re={class:"flex items-center"},je={class:"flex-1 text-base italic font-medium truncate"},Ee={class:"mt-1 text-xs ml-6 truncate"},Me=P({__name:"index",setup(c){const N=ne(),r=D(),{isMobile:f}=R(),p={invite:{title:"邀请好友",btn:"立即邀请",icon:"ant-design:user-add-outlined"},share:{title:"每日分享",btn:"立即分享",icon:"material-symbols:share"}},x=_(()=>{var t;return((t=r.authInfo)==null?void 0:t.user)||{}}),v=d([]),m=d(null),y=d(!1),b=d(null);d(!1),d("");const U=_(()=>{const t=m.value||{};return Array.isArray(t)?"可用余额不足":t.num===-1?`有效期：${t.expired_at}`:`有效次数：${t.num-t.used}次`}),u=async()=>{const{authInfo:t}=r;if(t)try{const a=await ae.getUserNum();m.value=a}catch{}},q=()=>{N.push({name:"Combo"})},z=async()=>{const t=await oe.getTaskList();v.value=t.filter(a=>a.type!=="register")},B=t=>{y.value=!0,b.value=t};return ee(()=>{u(),z(),r.getUserProfile()}),(t,a)=>(i(),k("div",$e,[l(e(ie),{"hide-back":e(f),title:"个人中心"},null,8,["hide-back"]),s("div",Se,[s("div",Ce,[s("div",Ie,[s("div",Ne,[s("div",Ue,[e(x).avatar?(i(),S(e(A),{key:0,size:"medium",round:"",src:e(x).avatar},null,8,["src"])):(i(),S(e(A),{key:1,size:"medium",round:"",src:e(le)},null,8,["src"]))])]),s("div",qe,[s("div",ze,[s("h1",Be,w(e(x).nickname??"AIyaaa"),1),s("div",Le,[l(e(C),{type:"primary",size:"tiny"},{default:h(()=>[I(" 普通用户 ")]),_:1})])])])])]),s("div",Te,[s("div",Ae,w(m.value?e(U):"可用余额不足"),1),l(e(C),{type:"primary",round:"",onClick:q},{default:h(()=>[I(" 去充值 ")]),_:1})]),v.value.length?(i(),k("div",Pe,[De,(i(!0),k(te,null,se(v.value,(o,n)=>(i(),k("div",{key:n,class:"bg-black rounded-lg shadow text-white py-2 px-3 mt-2"},[s("div",Re,[l(e(j),{icon:p[o.type].icon,class:"mr-1",style:{color:"#fff","font-size":"20px"}},null,8,["icon"]),s("div",je,w(o.title),1),l(e(C),{round:"",size:"small",style:{background:"#fff"},onClick:$=>B(o)},{default:h(()=>[I(w(p[o.type].btn),1)]),_:2},1032,["onClick"])]),s("div",Ee,w(o.desc),1)]))),128))])):L("",!0)]),l(e(we),{visible:y.value,"onUpdate:visible":a[0]||(a[0]=o=>y.value=o),data:b.value},null,8,["visible","data"]),e(f)?(i(),S(e(ue),{key:0})):L("",!0)]))}});const Fe=O(Me,[["__scopeId","data-v-ac5b0b8c"]]);export{Fe as default};
